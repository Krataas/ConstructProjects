name: "Build EcoEnchants chuyên sâu"

on: [workflow_dispatch] # Chạy thủ công cho chắc chắn

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: "Bước 1: Lấy code từ Auxilor"
        uses: actions/checkout@v4
        with:
          repository: Auxilor/EcoEnchants
          # Chúng ta lấy toàn bộ lịch sử để Gradle xác định được version
          fetch-depth: 0 

      - name: "Bước 2: Cài đặt JDK"
        uses: actions/setup-java@v4
        with:
          java-version: '21'
          distribution: 'temurin'
          cache: 'gradle'

      - name: "Bước 3: Cấp quyền và Build"
        # Sử dụng shell bash để đảm bảo lệnh chạy mượt mà
        run: |
          chmod +x gradlew
          ./gradlew assemble

      - name: "Bước 4: Xuất file JAR"
        uses: actions/upload-artifact@v4
        with:
          name: EcoEnchants-Latest
          path: "**/build/libs/*.jar" # Tìm kiếm đệ quy để tránh sót file
